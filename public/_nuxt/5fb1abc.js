(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{543:function(e,n,t){var content=t(622);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,t(22).default)("34079e08",content,!0,{sourceMap:!1})},619:function(e,n){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ticketComments"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ticket_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ticketComments"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"ticket_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"priority"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"comments"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"avatar"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"user_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"attachments"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"created_at"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:281}};t.loc.source={body:"query ticketComments($ticket_id: Int!)\n{\n  ticketComments(id: $ticket_id)\n  {\n    id\n    subject\n    message\n    status\n    priority\n    comments {\n      user {\n        id\n        name\n        avatar\n      }\n      user_id\n      content\n      attachments\n    }\n    created_at\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};function o(e,n){if("FragmentSpread"===e.kind)n.add(e.name.value);else if("VariableDefinition"===e.kind){var t=e.type;"NamedType"===t.kind&&n.add(t.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){o(e,n)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){o(e,n)})),e.definitions&&e.definitions.forEach((function(e){o(e,n)}))}var r={};function d(e,n){for(var i=0;i<e.definitions.length;i++){var element=e.definitions[i];if(element.name&&element.name.value==n)return element}}t.definitions.forEach((function(e){if(e.name){var n=new Set;o(e,n),r[e.name.value]=n}})),e.exports=t,e.exports.ticketComments=function(e,n){var t={kind:e.kind,definitions:[d(e,n)]};e.hasOwnProperty("loc")&&(t.loc=e.loc);var o=r[n]||new Set,l=new Set,c=new Set;for(o.forEach((function(e){c.add(e)}));c.size>0;){var m=c;c=new Set,m.forEach((function(e){l.has(e)||(l.add(e),(r[e]||new Set).forEach((function(e){c.add(e)})))}))}return l.forEach((function(n){var o=d(e,n);o&&t.definitions.push(o)})),t}(t,"ticketComments")},620:function(e,n){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"newTicket"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ticket_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"comment"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"attachments"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"Upload"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"newComment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"ticket_id"},value:{kind:"Variable",name:{kind:"Name",value:"ticket_id"}}},{kind:"Argument",name:{kind:"Name",value:"comment"},value:{kind:"Variable",name:{kind:"Name",value:"comment"}}},{kind:"Argument",name:{kind:"Name",value:"attachments"},value:{kind:"Variable",name:{kind:"Name",value:"attachments"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"avatar"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"attachments"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"created_at"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:307}};t.loc.source={body:"mutation newTicket(\n  $ticket_id: Int!\n  $comment: String!\n  $attachments: [Upload]\n\n)\n{\n  newComment(\n    ticket_id: $ticket_id\n    comment: $comment\n    attachments: $attachments\n  )\n  {\n    id\n    content\n    user {\n      id\n      name\n      avatar\n    }\n    content\n    attachments\n    created_at\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};function o(e,n){if("FragmentSpread"===e.kind)n.add(e.name.value);else if("VariableDefinition"===e.kind){var t=e.type;"NamedType"===t.kind&&n.add(t.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){o(e,n)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){o(e,n)})),e.definitions&&e.definitions.forEach((function(e){o(e,n)}))}var r={};function d(e,n){for(var i=0;i<e.definitions.length;i++){var element=e.definitions[i];if(element.name&&element.name.value==n)return element}}t.definitions.forEach((function(e){if(e.name){var n=new Set;o(e,n),r[e.name.value]=n}})),e.exports=t,e.exports.newTicket=function(e,n){var t={kind:e.kind,definitions:[d(e,n)]};e.hasOwnProperty("loc")&&(t.loc=e.loc);var o=r[n]||new Set,l=new Set,c=new Set;for(o.forEach((function(e){c.add(e)}));c.size>0;){var m=c;c=new Set,m.forEach((function(e){l.has(e)||(l.add(e),(r[e]||new Set).forEach((function(e){c.add(e)})))}))}return l.forEach((function(n){var o=d(e,n);o&&t.definitions.push(o)})),t}(t,"newTicket")},621:function(e,n,t){"use strict";t(543)},622:function(e,n,t){var o=t(21)((function(i){return i[1]}));o.push([e.i,".message[data-v-03f4e05a]{border-radius:10px}",""]),e.exports=o},623:function(e,n){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"me"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tickets"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"priority"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"created_at"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:105}};t.loc.source={body:"{\n  me\n  {\n    tickets {\n      id\n      subject\n      priority\n      status\n      created_at\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};function o(e,n){if("FragmentSpread"===e.kind)n.add(e.name.value);else if("VariableDefinition"===e.kind){var t=e.type;"NamedType"===t.kind&&n.add(t.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){o(e,n)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){o(e,n)})),e.definitions&&e.definitions.forEach((function(e){o(e,n)}))}var r={};t.definitions.forEach((function(e){if(e.name){var n=new Set;o(e,n),r[e.name.value]=n}})),e.exports=t},624:function(e,n){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"newTicket"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"priority"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"message"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"attachments"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"Upload"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"newTicket"},arguments:[{kind:"Argument",name:{kind:"Name",value:"subject"},value:{kind:"Variable",name:{kind:"Name",value:"subject"}}},{kind:"Argument",name:{kind:"Name",value:"priority"},value:{kind:"Variable",name:{kind:"Name",value:"priority"}}},{kind:"Argument",name:{kind:"Name",value:"message"},value:{kind:"Variable",name:{kind:"Name",value:"message"}}},{kind:"Argument",name:{kind:"Name",value:"attachments"},value:{kind:"Variable",name:{kind:"Name",value:"attachments"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"priority"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:279}};t.loc.source={body:"mutation newTicket(\n  $subject: String!\n  $priority: String!\n  $message: String!\n  $attachments: [Upload]\n\n)\n{\n  newTicket(\n    subject: $subject\n    priority: $priority\n    message: $message\n    attachments: $attachments\n  )\n  {\n    id\n    subject\n    priority\n    status\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};function o(e,n){if("FragmentSpread"===e.kind)n.add(e.name.value);else if("VariableDefinition"===e.kind){var t=e.type;"NamedType"===t.kind&&n.add(t.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){o(e,n)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){o(e,n)})),e.definitions&&e.definitions.forEach((function(e){o(e,n)}))}var r={};function d(e,n){for(var i=0;i<e.definitions.length;i++){var element=e.definitions[i];if(element.name&&element.name.value==n)return element}}t.definitions.forEach((function(e){if(e.name){var n=new Set;o(e,n),r[e.name.value]=n}})),e.exports=t,e.exports.newTicket=function(e,n){var t={kind:e.kind,definitions:[d(e,n)]};e.hasOwnProperty("loc")&&(t.loc=e.loc);var o=r[n]||new Set,l=new Set,c=new Set;for(o.forEach((function(e){c.add(e)}));c.size>0;){var m=c;c=new Set,m.forEach((function(e){l.has(e)||(l.add(e),(r[e]||new Set).forEach((function(e){c.add(e)})))}))}return l.forEach((function(n){var o=d(e,n);o&&t.definitions.push(o)})),t}(t,"newTicket")},669:function(e,n,t){"use strict";t.r(n);var o={name:"Ticket",props:["ticketId"],data:function(){return{valid:!1,sendCommentDialog:!1,comment:"",comments:[],ticket:{}}},mounted:function(){var e=this,n=this.ticketId;this.$apollo.query({query:t(619),variables:{ticket_id:n}}).then((function(t){e.comments=t.data.ticketComments.comments,e.ticket=t.data.ticketComments,e.$echo.channel("ticket."+n).listen("Ticket",(function(n){console.log(n),e.comments.push(n.comment)}))}))},methods:{getStatusColor:function(e){return"open"===e?"green":"pending"===e?"orange":"red"},getPriorityColor:function(e){return"high"===e?"red":"medium"===e?"orange":"green"},newComment:function(){var e=this,n=this.ticketId,o=this.comment;this.$apollo.mutate({mutation:t(620),variables:{ticket_id:n,comment:o,attachments:[]}}).then((function(n){e.comment="",e.sendCommentDialog=!1}))}}},r=(t(621),t(69)),d=t(79),l=t.n(d),c=t(220),m=t(198),v=t(68),k=t(495),f=t(487),h=t(199),y=t(470),component=Object(r.a)(o,(function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("v-card-text",{staticClass:"pa-2"},[t("div",{staticClass:"mt-5 mb-5"},[t("h3",{staticClass:"mt-2 mb-2"},[e._v("الموضوع: "+e._s(e.ticket.subject))]),e._v(" "),t("h3",{staticClass:"mt-2 mb-2"},[e._v("\n        الاهمية:\n        "),t("v-chip",{attrs:{color:e.getPriorityColor(e.ticket.priority),dark:"",small:""}},[e._v(e._s(e.$t(e.ticket.priority))+"\n        ")])],1),e._v(" "),t("h3",{staticClass:"mt-2 mb-2"},[e._v("\n        الحالة:\n        "),t("v-chip",{attrs:{color:e.getStatusColor(e.ticket.status),dark:"",small:""}},[e._v(e._s(e.$t(e.ticket.status))+"\n        ")])],1)]),e._v(" "),t("p",{staticClass:"text-center"},[e._v("\n      "+e._s(e.ticket.message)+"\n    ")]),e._v(" "),t("div",{staticClass:"messages",staticStyle:{"padding-bottom":"100px"}},e._l(e.comments,(function(n){return t("div",[n.user_id==e.$auth.user.id?t("div",{staticClass:"message mb-2 mt-2 blue white--text pa-2 elevation-6 ml-auto",staticStyle:{width:"fit-content"}},[e._v("\n          "+e._s(n.content)+"\n        ")]):t("div",{staticClass:"message mb-2 mt-2 mr-auto purple white--text pa-2 elevation-6",staticStyle:{width:"fit-content"}},[e._v("\n          "+e._s(n.content)+"\n        ")])])})),0)]),e._v(" "),t("v-card",{staticClass:"pa-2",staticStyle:{position:"fixed",bottom:"0px"},attrs:{height:"100px",width:"100%"}},[t("v-form",{model:{value:e.valid,callback:function(n){e.valid=n},expression:"valid"}},[t("v-text-field",{attrs:{rules:[function(n){return!!n||e.$t("validation.required")}]},model:{value:e.comment,callback:function(n){e.comment=n},expression:"comment"}},[t("v-btn",{attrs:{slot:"append",disabled:!e.valid,color:"blue",icon:""},on:{click:e.newComment},slot:"append"},[t("v-icon",[e._v("mdi-send")])],1)],1)],1)],1)],1)}),[],!1,null,"03f4e05a",null),N=component.exports;l()(component,{VBtn:c.a,VCard:m.a,VCardText:v.b,VChip:k.a,VForm:f.a,VIcon:h.a,VTextField:y.a});var S={name:"List",components:{Ticket:N},middleware:"auth",data:function(){return{search:"",dialog:!1,valid:!1,commentDialog:!1,headers:[{text:"رقم",align:"start",sortable:!0,value:"id"},{text:"الموضوع",align:"start",sortable:!1,value:"subject"},{text:"الحالة",value:"status"},{text:"تاريخ",value:"created_at"},{text:"الاولوية",value:"priority"},{text:"الإجراءات",value:"actions"}],tickets:[],ticketId:null,fields:{subject:"",priority:"",message:"",attachments:""}}},mounted:function(){var e=this;this.$apollo.query({query:t(623)}).then((function(n){e.tickets=n.data.me.tickets}))},methods:{getStatusColor:function(e){return"open"===e?"green":"pending"===e?"orange":"red"},getPriorityColor:function(e){return"high"===e?"red":"medium"===e?"orange":"green"},newTicket:function(){var e=this,n=this.fields,o=n.subject,r=n.priority,d=n.message,l=n.attachments;this.$apollo.mutate({mutation:t(624),variables:{subject:o,priority:r,message:d,attachments:l}}).then((function(n){e.tickets.push(n.data.newTicket),e.dialog=!1}))},openCommentDialog:function(e){this.ticketId=e,this.commentDialog=!0}}},_=t(460),w=t(665),V=t(509),x=t(494),T=t(492),C=t(456),D=t(605),F=t(74),$=t(474),E=Object(r.a)(S,(function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("section",[t("v-container",[t("v-card",{staticClass:"pa-4"},[t("v-card-text",[t("v-layout",[t("h3",[t("b",[e._v("المجموع")]),e._v(" "),t("v-chip",{staticClass:"white--text",attrs:{color:"blue"}},[e._v(e._s(e.tickets.length)+"\n            ")])],1),e._v(" "),t("v-spacer"),e._v(" "),t("v-btn",{staticClass:"white--text",attrs:{color:"blue"},on:{click:function(n){e.dialog=!0}}},[e._v("انشاء تذكرة جديدة\n          ")])],1)],1)],1)],1),e._v(" "),t("v-card",{staticClass:"mt-3"},[t("v-card-title",[e._v("\n     تذاكر\n      "),t("v-spacer"),e._v(" "),t("v-text-field",{attrs:{label:e.$t("search"),"append-icon":"mdi-magnify","hide-details":"","single-line":""},model:{value:e.search,callback:function(n){e.search=n},expression:"search"}})],1),e._v(" "),t("v-data-table",{attrs:{headers:e.headers,items:e.tickets,search:e.search},scopedSlots:e._u([{key:"item.status",fn:function(n){var o=n.item;return[t("v-chip",{attrs:{color:e.getStatusColor(o.status),dark:"",small:""}},[e._v(e._s(o.status)+"\n        ")])]}},{key:"item.priority",fn:function(n){var o=n.item;return[t("v-chip",{attrs:{color:e.getPriorityColor(o.priority),dark:"",small:""}},[e._v(e._s(o.priority)+"\n        ")])]}},{key:"item.actions",fn:function(n){var o=n.item;return[t("v-btn",{attrs:{color:"blue",icon:""},on:{click:function(n){return e.openCommentDialog(o.id)}}},[t("v-icon",[e._v("mdi-comment-eye")])],1)]}}])})],1),e._v(" "),t("v-dialog",{attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition"},model:{value:e.dialog,callback:function(n){e.dialog=n},expression:"dialog"}},[t("v-card",[t("v-toolbar",{attrs:{color:"blue",dark:""}},[t("v-btn",{attrs:{dark:"",icon:""},on:{click:function(n){e.dialog=!1}}},[t("v-icon",[e._v("mdi-close")])],1),e._v(" "),t("v-toolbar-title",[e._v("تذكرة جديدة")]),e._v(" "),t("v-spacer"),e._v(" "),t("v-toolbar-items",[t("v-btn",{attrs:{disabled:!e.valid,dark:"",text:""},on:{click:e.newTicket}},[e._v(e._s(e.$t("ارسال"))+"\n          ")])],1)],1),e._v(" "),t("v-card-text",[t("v-form",{model:{value:e.valid,callback:function(n){e.valid=n},expression:"valid"}},[t("v-text-field",{attrs:{label:e.الموضوع,rules:[function(n){return!!n||e.$t("validation.required")}]},model:{value:e.fields.subject,callback:function(n){e.$set(e.fields,"subject",n)},expression:"fields.subject"}}),e._v(" "),t("v-select",{attrs:{items:["high","medium","low"],label:e.$t("priority"),rules:[function(n){return!!n||e.$t("validation.required")}]},model:{value:e.fields.priority,callback:function(n){e.$set(e.fields,"priority",n)},expression:"fields.priority"}}),e._v(" "),t("v-textarea",{attrs:{label:e.$t("الرسالة"),rules:[function(n){return!!n||e.$t("validation.required")}]},model:{value:e.fields.message,callback:function(n){e.$set(e.fields,"message",n)},expression:"fields.message"}})],1)],1)],1)],1),e._v(" "),t("v-dialog",{attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition"},model:{value:e.commentDialog,callback:function(n){e.commentDialog=n},expression:"commentDialog"}},[t("v-card",[t("v-toolbar",{attrs:{color:"transparent",flat:""}},[t("v-btn",{attrs:{icon:""},on:{click:function(n){e.commentDialog=!1}}},[t("v-icon",[e._v("mdi-close")])],1),e._v(" "),t("v-toolbar-title",[e._v(e._s(e.$t("ticket")))])],1),e._v(" "),e.commentDialog?t("ticket",{attrs:{"ticket-id":e.ticketId}}):e._e()],1)],1)],1)}),[],!1,null,"35800854",null);n.default=E.exports;l()(E,{VBtn:c.a,VCard:m.a,VCardText:v.b,VCardTitle:v.c,VChip:k.a,VContainer:_.a,VDataTable:w.a,VDialog:V.a,VForm:f.a,VIcon:h.a,VLayout:x.a,VSelect:T.a,VSpacer:C.a,VTextField:y.a,VTextarea:D.a,VToolbar:F.a,VToolbarItems:$.a,VToolbarTitle:$.b})}}]);